### 1. Что такое «Строитель» (Builder)

**Строитель** — порождающий паттерн, который **пошагово** конструирует сложный объект, позволяя:

- отделить **сам процесс сборки** от конечного представления,
    
- собирать разные «вариации» одного продукта, не меняя клиентский код,
    
- делать сборку **побочным эффектом** ( fluent‑API, валидация, кэширование и т. д.).
    


`Клиент ──▶ Director (опционально) ──▶ Builder ──▶ Product`

#### Зачем он нужен

|Боль|Как помогает Builder|
|---|---|
|Конструктор с десятком аргументов|Разбивает создание на понятные шаги (`set_*`)|
|Нужно «по‑разному» собирать объект|Пишем несколько ConcreteBuilder‑ов|
|Нужна пошаговая валидация / логика|Проверяем каждое действие внутри билдера|

> ✂️ **Короткая аналогия** (и хватит): вы выбираете пиццу.  
> Повару (Builder) вы даёте инструкции: _тесто тонкое_, _сыр моцарелла_, _без анчоусов_.  
> В конце он отдаёт готовую пиццу (Product). Меню «Собери сам» — это Builder.

---

### 2. Мини‑теория: участники

|Роль|Суть|
|---|---|
|**Product**|итоговый сложный объект|
|**Builder**|интерфейс: `reset()`, `add_part_A()`, `add_part_B()` … `get_result()`|
|**ConcreteBuilder**|хранит частичное состояние, реализует шаги|
|**Director** (необязателен)|знает _рецепты_; вызывает шаги билдера в нужном порядке|
|**Client**|либо вызывает Builder напрямую, либо пользуется Director|

### 5. Полезные нюансы и приёмы

1. **Builder vs. Factory Method**  
    _Фабрика_ возвращает готовый объект «одним махом»; _Builder_ строит его **пошагово**.
    
2. **Director не обязателен**. В Python часто обходятся fluent‑API без отдельного директора.
    
3. **Иммутабельность продукта**. После `build()` лучше вернуть _копию_ или сделать `Product` неизменяемым (`@dataclass(frozen=True)`).
    
4. **Сброс состояния**. Один и тот же Builder можно переиспользовать, вызвав `reset()` или создав новый экземпляр.
    
5. **Частичная сборка**. Можно вернуть «недостроенный» объект (pattern _Step Builder_) — удобно для тестов.
    

---

### 6. Когда Builder не нужен

- Объект **простой** (2‑3 поля) — проще обычный `__init__`.
    
- Нет вариаций сборки, и она никогда не изменится.
    
- Производительность критична, а шаги билдера дают лишний оверхед (миллионы объектов в секунду).
    

---

### 7. Итого

**Строитель** — идеальный выбор, когда:

- конструктор распух до нечитаемости,
    
- нужно собирать разные конфигурации одного продукта,
    
- важно выполнять промежуточную валидацию и скрыть детали сборки.
    
